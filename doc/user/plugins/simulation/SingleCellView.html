<!DOCTYPE html>
<html>
    <head>
        <title>
            SingleCellView Plugin
        </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>

        <link href="../../res/stylesheet.css" rel="stylesheet" type="text/css"/>

        <script src="../../../3rdparty/jQuery/jquery.js" type="text/javascript"></script>
        <script src="../../../res/common.js" type="text/javascript"></script>
        <script src="../../res/menu.js" type="text/javascript"></script>
        <script src="../../res/imagepopup.js" type="text/javascript"></script>
    </head>
    <body ondragstart="return false;" ondrop="return false;">
        <script type="text/javascript">
            headerAndContentsMenu("SingleCellView Plugin", "../../..");
        </script>

        <p>
            The SingleCellView plugin can be used to run CellML models, which consist of either a system of <a href = "https://en.wikipedia.org/wiki/Ordinary_differential_equation">ordinary differential equations</a> (ODEs) or <a href="https://en.wikipedia.org/wiki/Differential_algebraic_equation">differential algebraic equations</a> (DAEs). The system may be <a href="https://en.wikipedia.org/wiki/Nonlinear_system">non-linear</a>.
        </p>

        <div class="section">
            Open a CellML file
        </div>

        <p>
            Upon opening a CellML file, OpenCOR will check that it can be used for simulation. If it cannot, then a message will describe the issue:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot01.png" width=360 height=270 imagepopup>
        </p>

        <p>
            On the other hand, if you open a valid CellML file (e.g. the <code>models/noble_model_1962.cellml</code> file, which is shipped with OpenCOR), then the view will look as follows:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot02.png" width=360 height=270 imagepopup>
        </p>

        <p>
            It consists of two main parts, the first of which allows you to customise the simulation, the solver and the model parameters, as well as to specify which simulation data to plot. The second part is used to plot the requested simulation data. In the <code>Parameters</code> section, all model parameters have an icon associated with them to highlight their type:
        </p>

        <table class="legend">
            <tbody>
                <tr>
                    <th>
                        <img src="res/pics/voi.png" width=16 height=16>
                    </th>
                    <td>
                        Variable of integration
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="res/pics/constant.png" width=16 height=16>
                    </th>
                    <td>
                        (Editable) constant
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="res/pics/computedConstant.png" width=16 height=16>
                    </th>
                    <td>
                        Computed constant
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="res/pics/state.png" width=16 height=16>
                    </th>
                    <td>
                        (Editable) state
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="res/pics/rate.png" width=16 height=16>
                    </th>
                    <td>
                        Rate
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="res/pics/algebraic.png" width=16 height=16>
                    </th>
                    <td>
                        Algebraic
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="section">
            Simulate an ODE model
        </div>

        <p>
            To simulate a model, you need to provide some information about the simulation itself, i.e. its starting point, ending point and point interval. Then, you need to specify the solver that you want to use. The solvers available to you will depend on which solver <a href="../index.html">plugins</a> you selected, as well as on the type of your model (i.e. <a href = "https://en.wikipedia.org/wiki/Ordinary_differential_equation">ODE</a> or <a href="https://en.wikipedia.org/wiki/Differential_algebraic_equation">DAE</a>). If you are dealing with an ODE model and all the solver plugins are selected, then <a href="http://computation.llnl.gov/projects/sundials-suite-nonlinear-differential-algebraic-equation-solvers/sundials-software">CVODE</a>, forward <a href="https://en.wikipedia.org/wiki/Euler_method">Euler</a>, <a href="https://en.wikipedia.org/wiki/Heun's_method">Heun</a>, and second- and fourth-order <a href="https://en.wikipedia.org/wiki/Rungeâ€“Kutta_methods">Runge-Kutta</a> will be available to you:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot03.png" width=360 height=270 imagepopup>
        </p>

        <p>
            Each solver comes with its own set of properties, which can be customised. For example, if you select <code>Euler (forward)</code> as the solver, you will see that it has only one property (<code>Step</code>):
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot04.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            You can start the simulation by pressing <code>F9</code> or by clicking on the <img src="../../../res/pics/oxygen/actions/media-playback-start.png" width=24 height=24 align=absmiddle> button. Then, or before, you can add a graph. All the model parameters are listed to the bottom-left of the view, grouped by components in which they were originally defined. To add a graph, right click on a model parameter and select against which other model parameter you want it to be plotted. For example, to create a graph for <code>V</code> (from the <code>membrane</code> component) against the variable of integration (i.e. time since the simulation properties are expressed in milliseconds):
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot05.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            You can get the information associated with a graph by double clicking on it:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot06.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            The <code>Model</code> property is used to associate the graph with a particular CellML file. By default, it has a value of <code>Current</code>, which means that if you select another CellML file, then OpenCOR will try to associate the graph with it (the <img src="../../../res/pics/oxygen/status/task-attention.png" width=24 height=24 align=absmiddle> icon will be shown next to the check box, if it cannot, as well as next to the <code>X</code> and/or <code>Y</code> properties to highlight which model parameter(s) could not be found in the other CellML file). The <img src="../../../res/pics/oxygen/status/object-unlocked.png" width=24 height=24 align=absmiddle> icon indicates that the graph is not locked, i.e. its <code>Model</code> property has a value of <code>Current</code>, while the <img src="../../../res/pics/oxygen/status/object-locked.png" width=24 height=24 align=absmiddle> icon is used when a graph is specifically associated with a CellML file (resulting in a red trace rather than a blue one). The <code>X</code> and <code>Y</code> properties can be modified either by editing their value or by right clicking on them and selecting another model parameter from the context menu, which can also be used to add or remove a graph.
        </p>

        <p>
            Back to the simulation, you can see that it failed with several model parameters having a value of <code>nan</code> (i.e. <a href="https://en.wikipedia.org/wiki/NaN">not a number</a>). This is because the solver was not properly set up: its <code>Step</code> property is too big. If you set it to <code>0.01 millisecond</code>s, reset all the model parameters (by clicking on the <img src="../../../res/pics/oxygen/actions/view-refresh.png" width=24 height=24 align=absmiddle> button) and clear the simulation data (by clicking on the <img src="../../../res/pics/oxygen/actions/trash-empty.png" width=24 height=24 align=absmiddle> button), and restart the simulation, then you get the following trace:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot07.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            The (roughly) same trace can also be obtained using the <code>CVODE</code> solver:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot08.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            However, the simulation is so quick to run that you will not have time to see its progress. Between the <img src="../../../res/pics/oxygen/actions/trash-empty.png" width=24 height=24 align=absmiddle> and <img src="../../../res/pics/oxygen/actions/list-add.png" width=24 height=24 align=absmiddle> buttons, there is a wheel that you can use to add a short delay between two data points. Thus, by using a value of <code>100,000</code> (or a bigger/smaller value, depending on the speed of your computer), you can run the simulation and pause it at a point of interest:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot09.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            Now, you can modify any of the model parameters identified by either the <img src="res/pics/state.png" width=16 height=16 align=absmiddle> or <img src="res/pics/constant.png" width=16 height=16 align=absmiddle> icon. Say that you want to set <code>g_Na_max</code> (from the <code>sodium_channel</code> component) to <code>0 milliS_per_cm2</code>. To resume the simulation will then give you the following result:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot10.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            If you want, you can export <em>all</em> the simulation data to a <a href="https://en.wikipedia.org/wiki/Comma-separated_values">comma-separated values</a> (CSV) file. To do so, you need to click on the <img src="../../../res/pics/oxygen/actions/document-export.png" width=24 height=24 align=absmiddle> button. Alternatively, if you want to create other graphs, but do not want them on the same graph panel as the existing one, you can click on the <img src="../../../res/pics/oxygen/actions/list-add.png" width=24 height=24 align=absmiddle> button to create a new graph panel:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot11.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            You might have noticed that the bottom graph panel has a blue vertical line to its left. This is to indicate that it is the currently selected graph panel (a graph panel can be selected by clicking on it). Something else you might have noticed is that the graphs area is now empty. This is because there are currently no graphs associated with the graph panel. Just for illustration, you can create a graph to plot <code>V</code> (from the <code>membrane</code> component) against <code>V'</code> (also from the <code>membrane</code> component):
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot12.png" width=360 height=270 imagepopup></a>
        </p>

        <p>
            You can create as many graph panels (and graphs) as you want. The current graph panel or all the graph panels (but the top one) can be removed by clicking on the <img src="../../../res/pics/oxygen/actions/list-remove.png" width=24 height=24 align=absmiddle> button.
        </p>

        <div class="section">
            Simulate a DAE model
        </div>

        <p>
            To simulate a <a href="https://en.wikipedia.org/wiki/Differential_algebraic_equation">DAE</a> model is similar to simulating an <a href = "https://en.wikipedia.org/wiki/Ordinary_differential_equation">ODE</a> model, except that OpenCOR only offers one DAE solver (<a href="http://computation.llnl.gov/projects/sundials-suite-nonlinear-differential-algebraic-equation-solvers/sundials-software">IDA</a>) at this stage:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot13.png" width=360 height=270 imagepopup></a>
        </p>

        <div class="section">
            Simulate a CellML 1.1 model
        </div>

        <p>
            So far, we have only simulated CellML 1.0 models, but you can also simulate CellML 1.1 models, i.e. models that import units and/or components from other models:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot14.png" width=360 height=270 imagepopup></a>
        </p>

        <div class="section">
            Simulate several models at the same time
        </div>

        <p>
            Each simulation is run in its own thread, which means that several simulations can be run at the same time. Simulations running in the background display a small progress bar in the top tab bar while the foreground simulation uses the main progress bar at the bottom of the view:
        </p>

        <p class="center">
            <img class="link" src="res/pics/SingleCellViewScreenshot15.png" width=360 height=270 imagepopup></a>
        </p>

        <div class="section">
            Plotting area
        </div>

        <p>
            The plotting area offers several features that can be activated by:
        </p>

        <ul>
            <li>
                <strong>Synchronising the X and/or Y axes:</strong>
                <ul>
                    <li>Using the context menu.</li>
                </ul>
            </li>
            <li>
                <strong>Using custom axes:</strong>
                <ul>
                    <li>Using the context menu.</li>
                </ul>
            </li>
            <li>
                <strong>Zooming in/out:</strong>
                <ul>
                    <li>Holding the right mouse button down, and moving the mouse to the bottom-right/top-left to zoom in/out; or</li>
                    <li>Moving the mouse wheel up/down; or</li>
                    <li>Using the context menu.</li>
                </ul>
            </li>
            <li>
                <strong>Resetting the zoom level:</strong>
                <ul>
                    <li>Double-clicking on the left mouse button; or</li>
                    <li>Using the context menu.</li>
                </ul>
            </li>
            <li>
                <strong>Zooming into a region of interest:</strong>
                <ul>
                    <li>Pressing <code>Ctrl</code> and holding the right mouse button down, and moving the mouse around.</li>
                </ul>
            </li>
            <li>
                <strong>Panning:</strong>
                <ul>
                    <li>Holding the left mouse button down, and moving the mouse around.</li>
                </ul>
            </li>
            <li>
                <strong>Showing the coordinates of any point:</strong>
                <ul>
                    <li>Pressing <code>Shift</code> and holding the left mouse button down, and moving the mouse around.</li>
                </ul>
            </li>
            <li>
                <strong>Copying the contents of the plotting area to the clipboard:</strong>
                <ul>
                    <li>Using the context menu.</li>
                </ul>
            </li>
        </ul>

        <div class="section">
            Tool bar
        </div>

        <table class="legend">
            <tbody>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/media-playback-start.png" width=24 height=24>
                    </th>
                    <td>
                        Run the simulation
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/media-playback-pause.png" width=24 height=24>
                    </th>
                    <td>
                        Pause the simulation
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/media-playback-stop.png" width=24 height=24>
                    </th>
                    <td>
                        Stop the simulation
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/view-refresh.png" width=24 height=24>
                    </th>
                    <td>
                        Reset all the model parameters
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/trash-empty.png" width=24 height=24>
                    </th>
                    <td>
                        Clear the simulation data
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/list-add.png" width=24 height=24>
                    </th>
                    <td>
                        Add a graph panel
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/list-remove.png" width=24 height=24>
                    </th>
                    <td>
                        Remove the current graph panel or all the graph panels
                    </td>
                </tr>
                <tr>
                    <th>
                        <img src="../../../res/pics/oxygen/actions/document-export.png" width=24 height=24>
                    </th>
                    <td>
                        Export the simulation data
                    </td>
                </tr>
            </tbody>
        </table>

        <script type="text/javascript">
            copyright("../../..");
        </script>
    </body>
</html>
